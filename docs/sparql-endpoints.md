# SPARQL endpoints

## Defining endpoints in settings

To add sparql endpoints to your application, you can define them in your Django settings. Add a setting `SPARQL_ENDPOINTS` to your settings file. For each endpoint, you will need to provide the following information:

- The route for the endpoint in the application.
- The graph that the endpoint connects to.
- Whether a query endpoint should be made.
- Whether an update endpoint should be made.
- Required permissions for the endpoint, if any.

These are explained in more detail below. Ultimately, you setting should be structured like so:

```python
SPARQL_ENDPOINTS = [
    {
        'route': 'foo',
        'graph': ('myapp.graphs', 'foo_graph'),
        'query': True,
        'update': True,
        'query_permissions': None,
        'update_permissions': [
            ('rest_framework.permissions', 'IsAdminUser')
        ],
    },
    {
        'route': 'bar',
        'graph': ('myapp.graphs', 'bar_graph'),
        'query': True,
        'update': False,
    }
]
```

The **route** should be a string. In the example above, the "foo" graph will get two endpoints: `/foo/query` and `/foo/update`. (The "bar" graph will only have `/bar/query`)

The **graph** should refer to a function that creates an rdflib `Graph` object. For example:

```python
from rdflib import Graph

def foo_graph():
    return Graph(...) # specify options
```

The setting itself should be a tuple of two strings: the module name and the name of the function. (We don't import the object directly to avoid circular imports; after all, the graph may depend on your settings.) In this example, you should be able to import the graphfunction as `from myapp.graphs import foo_graph`.

Note that you may want to use your configured store setting (see the [getting started guide](/getting-started)) in the graph constructor: `Graph(store = settings.RDFLIB_STORE)`

The **query** and **update** items control whether query and update endpoints should be added, respectively. (You should set at least one of these to `True` if you want something to happen.)

The **query_permissions** and **update_permissions** keys are optional: they can be left out or set to `None`. If defined, they should refer to permission classes based on the Django REST framework. See the [documentation on permissions](https://www.django-rest-framework.org/api-guide/permissions/). Like the graph functions, each permission is specified as a tuple consisting of the module name and the object name.

### Including configured sparql views

Finally, you must include the endpoints generated by the sparql app in your application. When you configure your project's url patterns, make sure to include the following:

```
from sparql import SPARQL_ROUTE

path(SPARQL_ROUTE, include('sparql.urls'))
```

## Defining endpoints as View classes

Instead of adding endpoints to your settings, you can also define your SPARQL views as subclasses of `SPARQLUpdateAPIView` and `SPARQLQueryAPIView` and include these views in your project.